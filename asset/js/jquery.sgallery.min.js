/*!
 * jQuery Gallery - CSS3 transitions and transformations
 * (c) 2011-2013 WP Themers
 */
;(function($,window,document,undefined){"use strict";var namespace="sGallery",defaults={};function Plugin(element,options){this.options=$.extend({},defaults,options);this.container=$(element);this.bigImageWrap=this.container.find('.items-big');this.bigImageItem=this.bigImageWrap.find('.item');this.count=this.bigImageItem.length,this.smallImageWrap=this.container.find('.items-small');this.smallImageItem=this.smallImageWrap.children('.item');this.isOldBrowser=!(Modernizr.opacity&&Modernizr.csstransforms&&Modernizr.csstransitions);this.current=null;this.initialHeight=0;this.minHeight='';this.controls=this.container.find('.controls');this.prev_button=this.controls.find('.prev').data('direction','prev').addClass('control');this.next_button=this.controls.find('.next').data('direction','next').addClass('control');this.grid_button=this.controls.find('.grid');this.control=this.controls.find('.control');this.current_class='current';this.$document=$(document);this.$window=$(window);this.slideshow=false;this.init()}Plugin.prototype={init:function(){var obj=this;obj.setItemDelays();obj.bindEventHandlers();obj.changeOnResize();obj.bigImageItem.transition({opacity:0,duration:0,delay:0}).css({'visibility':'visible'})},changeOnResize:function(){var obj=this;this.$window.load(function(){obj.$window.resize(function(){obj.initialHeight=obj.container.outerHeight();obj.adaptHeight()});obj.$window.trigger('resize')})},adaptHeight:function(){var currItemH=this.bigImageItem.eq(this.current).outerHeight(),smallItemWrapH=this.smallImageWrap.outerHeight(),finalH='';if(this.slideshow)finalH=currItemH;else finalH=smallItemWrapH;if(this.isOldBrowser){this.container.animate({'height':finalH+'px'},400);this.container.parents('.flex-viewport').animate({'height':finalH+'px'},400)}else this.container.height(finalH);this.container.parents('.flex-viewport').height(finalH)},setItemDelays:function(){this.smallImageItem.each(function(index){$(this).data('delay',0.075*index)})},bindEventHandlers:function(){var obj=this;this.smallImageItem.on('click',function(event){event.preventDefault();var clicked=$(this);obj.current=clicked.index();var transEnd="transitionend MSTransitionEnd webkitTransitionEnd oTransitionEnd";var startImg=obj.bigImageItem.eq(obj.current);obj.smallImageItem.not(clicked).removeClass(obj.current_class).end().eq(obj.current).addClass(obj.current_class);obj.fadeOutItems();obj.bigImageWrap.css({'z-index':2});obj.smallImageWrap.css({'z-index':1});if(obj.isOldBrowser){clicked.promise().done(function(){obj.bigImageItem.fadeTo(0,0).end().find(startImg).css('z-index','2').fadeTo(600,1);obj.slideshow=true;obj.showControls();obj.adaptHeight()})}else{clicked.on(transEnd,function(e){startImg.transition({scale:0.8,opacity:0,duration:0}).transition({scale:1.0,opacity:1,duration:600,delay:400}).css('z-index','2');obj.slideshow=true;obj.showControls();obj.adaptHeight();clicked.off(transEnd)})}});this.control.on('click',function(event){event.preventDefault();var direction=$(this).data('direction');(direction=='next')?obj.current++:obj.current--;if(obj.current<0)obj.current=obj.count-1;else if(obj.current==obj.count)obj.current=0;obj.moveToNextImage()});this.grid_button.on('click',function(){obj.quitSlideShow()})},fadeOutItems:function(){var obj=this;this.smallImageItem.each(function(index){if(obj.isOldBrowser){$(this).delay($(this).data('delay')*1000).fadeTo(600,0)}else{$(this).transition({scale:0,opacity:0,duration:600,delay:$(this).data('delay')*1000})}})},fadeInItems:function(){var obj=this;this.smallImageItem.each(function(index){if(obj.isOldBrowser){$(this).delay($(this).data('delay')*1000).fadeTo(600,1)}else{$(this).transition({scale:1,opacity:1,duration:600,delay:$(this).data('delay')*1000})}})},showControls:function(){this.controls.css('display','block').transition({opacity:1,duration:600,delay:600})},hideControls:function(){this.controls.transition({opacity:0,duration:600,delay:0}).css('display','none')},moveToNextImage:function(){var obj=this,currentImg=this.bigImageItem.eq(this.current);obj.adaptHeight();this.bigImageItem.not(currentImg).transition({opacity:0,duration:600,delay:0}).css('z-index','0');if(obj.isOldBrowser){currentImg.css('z-index','1').fadeTo(600,1)}else{currentImg.css('z-index','1').transition({scale:0.8,opacity:0,duration:0}).transition({scale:1.0,opacity:1,duration:600})}},quitSlideShow:function(){var currentImg=this.bigImageItem.eq(this.current);this.hideControls();this.fadeInItems();this.slideshow=false;if(this.isOldBrowser){currentImg.fadeTo(600,0)}else{currentImg.transition({scale:0,opacity:0,duration:600})}this.bigImageWrap.css({'z-index':1});this.smallImageWrap.css({'z-index':2});this.adaptHeight()}};$.fn[namespace]=function(options){return this.each(function(){if(!$.data(this,"plugin_"+namespace)){$.data(this,"plugin_"+namespace,new Plugin(this,options))}})}})(jQuery,window,document);